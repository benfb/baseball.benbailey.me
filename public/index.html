<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.20.3" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  
  <title>Ben Does Baseball</title>
  

  
  <link rel="stylesheet" href="https://baseball.benbailey.me/css/poole.css">
  <link rel="stylesheet" href="https://baseball.benbailey.me/css/syntax.css">
  <link rel="stylesheet" href="https://baseball.benbailey.me/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,400i,700|Open+Sans:400,400italic,700|Fugaz+One">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="https://baseball.benbailey.me/index.xml" rel="alternate" type="application/rss+xml" title="Ben Does Baseball" />
</head>

<body class="theme-base-09 ">

<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://baseball.benbailey.me/"><h1>Ben Does Baseball</h1></a>
      <p class="lead">
       A home for Ben Bailey&#39;s baseball analytics projects. 
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      <li><a href="https://github.com/benfb/baseball">Code</a> </li>
      
        <li><a href="/schedule/"> Schedule </a></li>
      
    </ul>

    <p>&copy; 2017. All rights reserved. </p>
  </div>
</div>


    <div class="content container">
<div class="posts">

      
        
  <div class="post">
    <h1 class="post-title">
      <a href="https://baseball.benbailey.me/2017/05/syndergaard-next-year/">
        Can Noah Syndergaard Make It Through the Next Year?
      </a>
    </h1>

    <span class="post-date">Wed, May 3, 2017</span>

    <p>Probably not.</p>

<p>The Mets are not healthy. Their five best starters would combine to make one of the better starting rotations in recent history. Unfortunately, it is seeming increasingly unlikely that all five will pitch at the same time again. Steven Matz finished 2016 with a surgery to remove a bone spur in his elbow. He hasn&rsquo;t pitched yet this season. Matt Harvey had season-ending surgery to alleviate thoracic outlet syndrome after a disappointing start to the season. Jacob deGrom missed the last part of 2016 for ulnar nerve surgery. Depth option Seth Lugo is out with a partial UCL tear.</p>

<p>Noah Syndergaard is the only one of the five to not have had Tommy John surgery. Despite pitching through a bone spur last season, he has been remarkably healthy. However, he left his opening day start this season with a blister. And now this:</p>

<p><blockquote class="twitter-tweet" data-lang="en"><p lang="nl" dir="ltr">Update on Noah Syndergaard. <a href="https://twitter.com/hashtag/Mets?src=hash">#Mets</a> <a href="https://t.co/n8JVxIBBid">pic.twitter.com/n8JVxIBBid</a></p>&mdash; New York Mets (@Mets) <a href="https://twitter.com/Mets/status/859063648714579969">May 1, 2017</a></blockquote> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></p>

<p>As others have noted, lat strains can be fairly serious—Matz missed two months with the same injury in 2015. Syndergaard is probably out until at least the All-Star break, a big blow to the Mets. The big story here of course is that the Mets started Syndergaard even after he refused a suggested MRI. However, I believe a further, more serious injury awaits Syndergaard.</p>

<p>Syndergaard didn&rsquo;t always throw a slider:</p>

<p><img src="/images/syndergaard/syndergaard_usage.svg" alt="Syndergaard Pitch Usage" /></p>

<p>Indeed, he started throwing it toward the end of 2015 (his rookie season), and relied heavily on it in 2016.</p>

<p>There&rsquo;s been a lot of work on this topic. Fangraphs&rsquo; Eno Sarris termed the pitch the Mets are throwing the <a href="http://www.fangraphs.com/blogs/the-mets-are-throwing-the-dan-warthen-slider/">&ldquo;Dan Warthen Slider&rdquo;</a> in 2015. Sarris notes in his piece:</p>

<blockquote>
<p>Critics might point to arm injuries on the Mets as proof that the pitch is hard on the arm, but Warthen laughs that off. &ldquo;It’s easy on the arm when done correctly, it’s not one of those pitches that you try to make break,&rdquo; he said. And these pitchers all throw hard, and <a href="http://www.hardballtimes.com/velocitys-relationship-with-pitcher-arm-injuries/">there is a relationship</a> between just throwing hard and arm injury. It’s impossible to split those effects apart.</p>
</blockquote>

<p>Obviously there&rsquo;s more contributing factors to injury than throwing this one specific slider. The Mets&rsquo; five aces throw very hard. Perhaps more importantly, they all throw breaking pitchers (the Warthen slider) very hard.</p>

<div>
    <a href="https://plot.ly/~benfb/18/?share_key=3Xr8fn3QimJTIGhLF4pd3a" target="blank" title="Tommy John and Sliders" style="display: block; text-align: center;"><img src="https://plot.ly/~benfb/18.png?share_key=3Xr8fn3QimJTIGhLF4pd3a" alt="Tommy John and Sliders" style="max-width: 100%;width: 600px;"  width="600" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
    <script data-plotly="benfb:18" sharekey-plotly="3Xr8fn3QimJTIGhLF4pd3a" src="https://plot.ly/embed.js" async></script>
</div>

<p>This is a graph of pitchers who threw at least 250 sliders between 2015 and 2017. Perceived velocity is on the y-axis, and is correlated with release extension on the x-axis (the farther a pitcher&rsquo;s arm gets from the mound, the faster the ball will appear to a hitter).</p>

<p>The only pitcher with a slider that has averaged above 90 MPH in effective speed that hasn&rsquo;t had Tommy John surgery yet is&hellip;Noah Syndergaard. Jon Gray and Jake Arrieta are both also near the threshold.</p>

<p><img src="/images/syndergaard/arrieta_usage.svg" alt="Arrieta Pitch Usage" /></p>

<p>Arrieta <a href="http://www.fangraphs.com/blogs/jake-arrietas-one-grip-multi-slider/">throws a mix of a cutter and slider</a>. When he was traded to the Cubs from the Orioles in July 2013, his month to month slider usage began increasing almost immediately. In 2014, his first full season with the Cubs, he threw the pitch 29% of the time. In 2015, he threw it 29.5% of the time. However, his usage has decreased since then, and now sits at 16.1% so far this year (potentially due to his <a href="http://www.fangraphs.com/blogs/jake-arrieta-has-developed-a-problem/">lost command</a> of it). He threw his slider more than 20% of the time for about two years, and then decreased his usage again. It&rsquo;s not too surprising that his arm has held up, especially considering his conditioning.</p>

<p>DeGrom got Tommy John surgery at 22, Harvey 24, Wheeler 25, and Matz 19. Syndergaard is 24 now. Out of the two who had Tommy John in the Majors, Harvey pitched for 1.5 years at the Major League level before needing surgery and Wheeler had about the same amount of time as well. Syndergaard has been pitching for about half a year longer than either of them, but it&rsquo;s concerning how much the timelines line up. Syndergaard is just a little past the mean age of Tommy John surgery in the last 10 years (23.28).</p>

<p>Jon Gray is an interesting case due to his frequent comparisons to Syndergaard. His arm seems healthy now, but he&rsquo;s also only pitched for a year and a half so far. I wouldn&rsquo;t be surprised if he ends up in the same position as Syndergaard soon, though, especially since it appears that <a href="http://www.fangraphs.com/blogs/jon-gray-thinks-hes-noah-syndergaard/">he&rsquo;s started throwing the slider even harder</a> in limited starts this season.</p>

<p>Maybe Syndergaard&rsquo;s injury is a blessing in disguise. There&rsquo;s only one other pitcher I could find in the past seven years that&rsquo;s undergone Tommy John surgery after a lat strain or tear. However, many have gotten lat strains after Tommy John (including Syndergaard&rsquo;s teammate Matz). It&rsquo;s certainly good that he&rsquo;s not trying to pitch through it. If he does rush back or not take the injury seriously, though, it could put even more strain on his likely endangered elbow. Due to Syndergaard&rsquo;s attitude about this situation so far, his desire to throw as hard as possible, and the Mets&rsquo; reliance on and mismanagement of him, I doubt he makes it through 2018 with his elbow intact.</p>

  </div>
    
  
        
  <div class="post">
    <h1 class="post-title">
      <a href="https://baseball.benbailey.me/2017/04/spin-room/">
        The Spin Room
      </a>
    </h1>

    <span class="post-date">Wed, Apr 26, 2017</span>

    <p>Spin is one of the most-discussed relatively new Statcast metrics. It is especially relevant when looking at four-seam fastballs, as that pitch tends to be the most straightforward and therefore easiest to predict movement-wise. We know spin has a positive effect on fastballs, but what is the extent of that effect? Are there any potential cons to throwing a ball with such a high spin rate?</p>

<p>Here are the four-seam spin kings from 2015-2017<sup class="footnote-ref" id="fnref:1"><a rel="footnote" href="#fn:1">1</a></sup>:</p>

<table>
<thead>
<tr>
<th>Rank</th>
<th>Name</th>
<th>Pitches</th>
<th>Spin (RPM)</th>
</tr>
</thead>

<tbody>
<tr>
<td>1</td>
<td>Andrew Bailey</td>
<td>582</td>
<td>2669</td>
</tr>

<tr>
<td>2</td>
<td>Carl Edwards Jr.</td>
<td>521</td>
<td>2656</td>
</tr>

<tr>
<td>3</td>
<td>Rafael Betancourt</td>
<td>379</td>
<td>2562</td>
</tr>

<tr>
<td>4</td>
<td>Jose Leclerc</td>
<td>151</td>
<td>2560</td>
</tr>

<tr>
<td>5</td>
<td>Matt Bush</td>
<td>707</td>
<td>2558</td>
</tr>

<tr>
<td>6</td>
<td>Tyson Ross</td>
<td>610</td>
<td>2539</td>
</tr>

<tr>
<td>7</td>
<td>Justin Verlander</td>
<td>3532</td>
<td>2534</td>
</tr>

<tr>
<td>8</td>
<td>Max Scherzer</td>
<td>4005</td>
<td>2526</td>
</tr>

<tr>
<td>9</td>
<td>Yimi Garcia</td>
<td>605</td>
<td>2524</td>
</tr>

<tr>
<td>10</td>
<td>Yu Darvish</td>
<td>742</td>
<td>2522</td>
</tr>

<tr>
<td>11</td>
<td>Garett Richards</td>
<td>984</td>
<td>2513</td>
</tr>

<tr>
<td>12</td>
<td>Edubray Ramos</td>
<td>381</td>
<td>2508</td>
</tr>

<tr>
<td>13</td>
<td>David Robertson</td>
<td>136</td>
<td>2507</td>
</tr>

<tr>
<td>14</td>
<td>Aroldis Chapman</td>
<td>1513</td>
<td>2507</td>
</tr>

<tr>
<td>15</td>
<td>Yohan Pino</td>
<td>120</td>
<td>2502</td>
</tr>
</tbody>
</table>

<p>A rather large number of these pitchers are dealing or have recently dealt with arm injuries. Garrett Richards only made six starts last year and is out until at least June, and Tyson Ross hasn&rsquo;t pitched since April 4th of 2016. Yu Darvish missed all of 2015 and half of 2016. Andrew Bailey missed all of 2014 and pitched 8.2 major league innings in 2015 before putting in a 43.2 inning season with mixed results in 2016. He&rsquo;s currently on the 10-day DL for right shoulder inflammation. The Cubs are carefully limiting their usage of Edwards. Yimi Garcia pitched 56.2 innings for the Dodgers last year, but only made it through 8.1 this season before having to undergo Tommy John surgery.</p>

<p>Whether this high frequency of injuries is specific to high-spin fastball pitchers or not is unclear, but it certainly seems worth investigating. Of course, many of these pitchers also hit the high 90s, which may have more to do with it.</p>

<p>Another thing that&rsquo;s important to notice is that high fastball spin does not necessarily entail high quality results. Rafael Betancourt threw 39.1 innings for Colorado in 2015 but allowed an ERA of 6.18 and a FIP of 3.34. He hasn&rsquo;t pitched in the majors since (presumably he retired after that year, his age 40 season). Yohan Pino hasn&rsquo;t pitched in the Majors since 2015, spending 2016 in the KBO. Edubray Ramos is off to a slow start with the Phillies this season, though he did complete 40 relatively high quality innings last season.</p>

<p>On the flip side, some of the games best and most promising pitchers show up on this list. Max Scherzer and Justin Verlander are both seasoned aces and Cy-Young winners. Jose Leclerc is a promising young prospect for the Rangers who struggles with command (though he&rsquo;s only allowed one walk in nine innings so far this year). It&rsquo;s impressive that he&rsquo;s so high on the leaderboard despite being only 23. (Interestingly, four of the top 15 four-seam spin rates belong to Rangers.) Carl Edwards pitched in the tenth inning of game seven of the World Series and looks to be the Cubs&rsquo; potential closer of the future. Aroldis Chapman is as durable and dominant as ever. Matt Bush continues to move up the ranks in the Rangers&rsquo; bullpen, allowing just one hit in his last three appearances (all in the ninth inning). David Robertson remains a quality closer despite a slight down year last year.</p>

<p>High spin rate is obviously not the only key to pitching success, especially when just looking at one pitch. However, high four-seam spin rate does seem to be correlated to some amount of potential, if not direct success. And some of the game&rsquo;s most dominant pitchers are near the top of this list. It will be interesting to see how the baseball community treats spin data as it continues to become more accessible.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">Minimum of 100 qualifying pitches. Statcast spin data appears to only go back to 2015. Data from <a href="https://baseballsavant.mlb.com/statcast_search?hfPT=FF%7C&amp;hfAB=&amp;hfBBT=&amp;hfPR=&amp;hfZ=&amp;stadium=&amp;hfBBL=&amp;hfNewZones=&amp;hfGT=R%7C&amp;hfC=&amp;hfSea=2017%7C2016%7C2015%7C&amp;hfSit=&amp;player_type=pitcher&amp;hfOuts=&amp;opponent=&amp;pitcher_throws=&amp;batter_stands=&amp;hfSA=&amp;game_date_gt=&amp;game_date_lt=&amp;team=&amp;position=&amp;hfRO=&amp;home_road=&amp;hfFlag=&amp;metric_1=&amp;hfInn=&amp;min_pitches=0&amp;min_results=100&amp;group_by=name&amp;sort_col=spin_rate&amp;player_event_sort=h_launch_speed&amp;sort_order=desc&amp;min_abs=0#results">Baseball Savant</a>.
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
</ol>
</div>

  </div>
    
  
        
  <div class="post">
    <h1 class="post-title">
      <a href="https://baseball.benbailey.me/2017/04/starters-cant-finish/">
        Starters Who Can&#39;t Finish What They Started
      </a>
    </h1>

    <span class="post-date">Wed, Apr 19, 2017</span>

    <p>Every pitcher performs differently in different scenarios. Some starters can&rsquo;t finish innings. More specifically, some starters are pretty good at getting two outs, but much worse at getting the third. In looking at potential ways to identify starters who may work better as relievers, I came across Baseball Reference&rsquo;s number of outs splits. To find good candidates for this analysis, I looked at <a href="http://www.fangraphs.com/leaderssplits.aspx?splitArr=56&amp;strgroup=season&amp;statgroup=1&amp;startDate=2016-4-3&amp;endDate=2016-11-01&amp;filter=&amp;position=P&amp;statType=player&amp;autoPt=true&amp;sort=5,1&amp;pg=0">Fangraphs&rsquo; splits leaderboard for worst ERA with two outs</a>. I took the top (or bottom) three pitchers with more than 30 IP: Tyler Duffey, Anibal Sanchez, and Michael Pineda.</p>

<p>For a quick refresher, tOPS+ refers to how well a player performed in a particular split compared to as a whole with 100 as an average. sOPS+ is how well a player performed in a split compared to how the league performed in that same split on average.</p>

<p>We&rsquo;ll look at Duffey and Sanchez first before getting to the more interesting case of Pineda:</p>

<p><strong>Tyler Duffey</strong></p>

<table>
<thead>
<tr>
<th>Outs</th>
<th>ERA</th>
<th>tOPS+</th>
<th>sOPS+</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>4.74</td>
<td>100</td>
<td>128</td>
</tr>

<tr>
<td>1</td>
<td>5.15</td>
<td>66</td>
<td>94</td>
</tr>

<tr>
<td>2</td>
<td>9.90</td>
<td>132</td>
<td>184</td>
</tr>
</tbody>
</table>

<p><strong>Anibal Sanchez</strong></p>

<table>
<thead>
<tr>
<th>Outs</th>
<th>ERA</th>
<th>tOPS+</th>
<th>sOPS+</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>4.22</td>
<td>114</td>
<td>132</td>
</tr>

<tr>
<td>1</td>
<td>3.96</td>
<td>55</td>
<td>72</td>
</tr>

<tr>
<td>2</td>
<td>9.82</td>
<td>125</td>
<td>160</td>
</tr>
</tbody>
</table>

<p>Neither Duffey nor Sanchez were great last year, but they were both awful with two outs. Interestingly, both were better than league average with one out, but worse with no outs, and even worse with two.</p>

<p>(As a side note, last year Sanchez&rsquo; fellow Tigers Jordan Zimmerman and Mike Pelfrey had top 20 ERAs with two outs as well.)</p>

<p>Michael Pineda is notoriously frustrating to watch. Despite flashes of brilliance, he has never quite been able to put it all together for a sustained period of time. Part of that appears to be his struggles with two outs:</p>

<table>
<thead>
<tr>
<th>Outs</th>
<th>ERA</th>
<th>tOPS+</th>
<th>sOPS+</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>2.47</td>
<td>75</td>
<td>80</td>
</tr>

<tr>
<td>1</td>
<td>3.53</td>
<td>71</td>
<td>80</td>
</tr>

<tr>
<td>2</td>
<td>8.84</td>
<td>148</td>
<td>172</td>
</tr>
</tbody>
</table>

<p>All three of these pitchers allowed a better than league average OPS with one out. Michael Pineda was better than league average with both zero and one out(s). However, he&rsquo;s worse than Anibal Sanchez at his worst with two outs!</p>

<p>In a very small sample size (~25 plate appearances each), Pineda does not seem to have alleviated his struggles with two outs in 2017, despite a 23 K/BB ratio and a total sOPS+ of 73:</p>

<table>
<thead>
<tr>
<th>Outs</th>
<th>tOPS+</th>
<th>sOPS+</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>126</td>
<td>99</td>
</tr>

<tr>
<td>1</td>
<td>28</td>
<td>7</td>
</tr>

<tr>
<td>2</td>
<td>140</td>
<td>109</td>
</tr>
</tbody>
</table>

<p>Interestingly, while Pineda got lit up on his first start, allowing four runs in 3.2 innings, in his second he took a perfect game into the seventh and only allowed three runs across his last two starts.</p>

<p>Anibal Sanchez has appeared only as a reliever thus far this year and has allowed 15 runs in 9 innings. Tyler Duffey has also only been a reliever for the Twins, though he hasn&rsquo;t allowed any runs in 8.2 innings, with only one walk and seven strikeouts. Across a very small sample size, he has allowed an sOPS+ of 28, -20, and 29 with 0, 1, and 2 outs respectively. Duffey has performed best in high leverage situations, while Sanchez has only faced one hitter in such a situation (he allowed a home run).</p>

  </div>
    
  
        
  <div class="post">
    <h1 class="post-title">
      <a href="https://baseball.benbailey.me/2017/04/kris-bryant-reds/">
        Kris Bryant Loves the Reds
      </a>
    </h1>

    <span class="post-date">Wed, Apr 5, 2017</span>

    <p>Kris Bryant was very good last year. The Reds were&hellip;not great last year. In fact, the Reds&rsquo; bullpen was historically bad. Early in the season they <a href="http://m.mlb.com/news/article/176059016/reds-bullpen-has-record-streak-allowing-runs/">set a record for consecutive games allowing at least one run</a>, and later in the season they <a href="http://m.reds.mlb.com/news/article/201830542/reds-bullpens-sets-record-for-homers-allowed/">set a record for home runs allowed</a>.</p>

<p>Kris Bryant, of course, was the National League MVP.</p>

<p>This is what the MVP did against normal pitching in 699 plate appearances:</p>

<table>
<thead>
<tr>
<th>BA</th>
<th>HR</th>
<th>OBP</th>
<th>SLG</th>
<th>OPS+</th>
</tr>
</thead>

<tbody>
<tr>
<td>.292</td>
<td>29</td>
<td>.385</td>
<td>.554</td>
<td>149</td>
</tr>
</tbody>
</table>

<p>This is what Kris Bryant did to Reds pitching in 88 plate appearances:</p>

<table>
<thead>
<tr>
<th>BA</th>
<th>HR</th>
<th>OBP</th>
<th>SLG</th>
<th>tOPS+</th>
</tr>
</thead>

<tbody>
<tr>
<td>.364</td>
<td>10</td>
<td>.443</td>
<td>.831</td>
<td>165</td>
</tr>
</tbody>
</table>

<p>tOPS+ is a measure of how well a player performed in this split as opposed to their average. Imagine a normal Major League Baseball player. Now imagine Kris Bryant. The difference between these two players is less than the difference between Kris Bryant being pitched to by the Reds and normal Kris Bryant. Against-Reds Kris Bryant is to normal Kris Bryant as normal Kris Bryant is to a league-average hitter.</p>

<p>sOPS+ shows how well a player performed in a split compared to the league average in that split. Bryant&rsquo;s sOPS+ against the Reds was 211. That speaks for itself.</p>

<p>In fact, more than 25% of Bryant&rsquo;s home runs were against the Reds. A more modest 20.7% of his extra-base hits were against them.</p>

<p>This was Reds pitching against everyone:</p>

<table>
<thead>
<tr>
<th>ERA</th>
<th>BA</th>
<th>HR</th>
<th>K/BB</th>
<th>sOPS+</th>
</tr>
</thead>

<tbody>
<tr>
<td>4.91</td>
<td>.263</td>
<td>258</td>
<td>1.95</td>
<td>116</td>
</tr>
</tbody>
</table>

<p>This was Reds Pitching against the Cubs:</p>

<table>
<thead>
<tr>
<th>ERA</th>
<th>BA</th>
<th>HR</th>
<th>K/BB</th>
<th>tOPS+</th>
</tr>
</thead>

<tbody>
<tr>
<td>6.99</td>
<td>.285</td>
<td>42</td>
<td>1.39</td>
<td>125</td>
</tr>
</tbody>
</table>

<p>So the Reds were worse against the Cubs than against the league as a whole.</p>

<p>The advanced batted ball data backs up Bryant&rsquo;s Reds dominance:</p>

<table>
<thead>
<tr>
<th>Reds?</th>
<th>Angle</th>
<th>Velocity</th>
<th>Distance</th>
<th>Barrel %</th>
</tr>
</thead>

<tbody>
<tr>
<td>No</td>
<td>19.5</td>
<td>89.6</td>
<td>235.1</td>
<td>16.4%</td>
</tr>

<tr>
<td>Yes</td>
<td>21.9</td>
<td>91.3</td>
<td>250.1</td>
<td>22.9%</td>
</tr>
</tbody>
</table>

<p>Against the Reds, Bryant&rsquo;s batted ball profile had a more optimal launch angle and greater velocity, distance, and barrel frequency.<sup class="footnote-ref" id="fnref:1"><a rel="footnote" href="#fn:1">1</a></sup></p>

<p>The code for this analysis is located here.<sup class="footnote-ref" id="fnref:2"><a rel="footnote" href="#fn:2">2</a></sup> Much of the data for this post was collected from Baseball Reference.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1"><a href="http://m.mlb.com/glossary/statcast/barreled-ball">http://m.mlb.com/glossary/statcast/barreled-ball</a>
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
<li id="fn:2"><a href="https://gist.github.com/benfb/d4c85ba9aac3ad8d5e0c3304eb2d696a">https://gist.github.com/benfb/d4c85ba9aac3ad8d5e0c3304eb2d696a</a>
 <a class="footnote-return" href="#fnref:2"><sup>[return]</sup></a></li>
</ol>
</div>

  </div>
    
  
        
  <div class="post">
    <h1 class="post-title">
      <a href="https://baseball.benbailey.me/2017/03/starters-through-innings/">
        Tracing Starter Performance by Inning
      </a>
    </h1>

    <span class="post-date">Tue, Mar 28, 2017</span>

    <p>In an attempt to sharpen my data visualization skills, I decided to look at some of the top starters from the 2016 season by inning. The pitchers were selected by a combination of innings pitched, complete games, and personal preference. Each pitcher pitched at least 150 innings last season. One thing to keep in mind with all of these is that as the game goes on the sample size decreases. Starters rarely made it through the ninth inning this season, so later game results should be taken with a grain of salt. This type of analysis is best for getting a broad idea of a pitcher.<sup class="footnote-ref" id="fnref:1"><a rel="footnote" href="#fn:1">1</a></sup></p>

<p><em>The x-axis for each of these graphs is innings. The y-axis varies based on the metric being measured.</em></p>

<p><strong>Velocity</strong>
<img src="/images/starters/velo.png" alt="" /></p>

<p>Every pitcher except Scherzer and Verlander (both past Tigers, coincidentally) featured 2-3 pitches that had very similar velocity at the top of the charts. All the pitchers featured a curveball of some sort that averaged below 80 mph except Kluber whose averaged 84+ mph.</p>

<p><strong>Spin</strong>
<img src="/images/starters/spin.png" alt="" /></p>

<p>Kyle Hendricks&rsquo; spin rate varies wildly from inning to inning. His pitches are grouped closer together, which plays into his strategy of deceiving hitters with consistency until it&rsquo;s too late. Hendricks also has one of the lower average spin rates, with only Kluber&rsquo;s chart having the same axis. In contrast, David Price throws three pitches that all had an average spin rate of over 2000 throughout the entire game. Max Scherzer&rsquo;s slider, on the other hand, spun around 1/4th as much on average.</p>

<p><strong>Break</strong>
<img src="/images/starters/break.png" alt="" /></p>

<p>Curveballs tend to have the greatest average break, followed by changeups, sliders, and sinkers, with cutters and two- and four-seam fastballs at the bottom. Curveball break tends to go down in the ninth inning. Even Rick Porcello&rsquo;s break takes a very slight downturn then, despite it having the highest break by far.</p>

<p>In terms of more general observations, check out Johnny Cueto&rsquo;s remarkably inconsistent curveball. The pitch varies the most in all three metrics inning-to-inning, and he didn&rsquo;t throw it past the seventh inning. Of course, he only threw it 11 times all season, and only twice in a day once. He never threw it with a runner on base, and preferred to throw it with nobody out. The pitch had pretty good results: five balls, three called strikes, one swinging strike, a groundout and a popout.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">The code for this analysis is <a href="https://gist.github.com/benfb/bc3ce96cdd00bb011f06aa34e183b4d9">here</a>.
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
</ol>
</div>

  </div>
    
  
        
  <div class="post">
    <h1 class="post-title">
      <a href="https://baseball.benbailey.me/2017/03/carl-edwards-jr-bad-day-great-year/">
        Carl Edwards Had a Bad Day in a Great Year
      </a>
    </h1>

    <span class="post-date">Thu, Mar 16, 2017</span>

    <p><em>This post was featured on the Fangraphs community blog <a href="http://www.fangraphs.com/community/carl-edwards-had-a-bad-day-in-a-great-year/">here</a></em></p>

<p>This week I played around with the <a href="http://billpetti.github.io/baseballr"><code>baseballr</code></a> package, which provides easy access to FanGraphs, Baseball Reference, and Statcast data in R<sup class="footnote-ref" id="fnref:1"><a rel="footnote" href="#fn:1">1</a></sup>.</p>

<p>I&rsquo;ve been particularly intrigued recently by <a href="http://www.baseball-reference.com/players/e/edwarca01.shtml">Carl Edwards Jr.</a>, a Cubs reliever who got called up last season. He had always seemed to be surprisingly good, but I wasn&rsquo;t aware quite how good he was until I calculated <a href="http://www.fangraphs.com/library/offense/woba/">wOBA</a> allowed by pitchers in 2016 and found that he had the third lowest in the league, behind only Kenley Jansen and Zach Britton, and in front of Clayton Kershaw, Aroldis Chapman, and Andrew Miller. Ranking Edwards among four of the game&rsquo;s top closers and the game&rsquo;s best starter seemed strange. Here are the six pitchers with the lowest wOBA-against last season:</p>

<table>
<thead>
<tr>
<th>Name</th>
<th>IP</th>
<th>ERA</th>
<th>WHIP</th>
<th>BABIP</th>
<th>FIP</th>
<th>wOBA</th>
</tr>
</thead>

<tbody>
<tr>
<td>Zach Britton</td>
<td>67.0</td>
<td>0.54</td>
<td>0.836</td>
<td>0.231</td>
<td>1.80</td>
<td>0.188</td>
</tr>

<tr>
<td>Kenley Jansen</td>
<td>68.2</td>
<td>1.83</td>
<td>0.670</td>
<td>0.244</td>
<td>1.34</td>
<td>0.188</td>
</tr>

<tr>
<td>Carl Edwards</td>
<td>36.0</td>
<td>3.75</td>
<td>0.806</td>
<td>0.162</td>
<td>2.79</td>
<td>0.201</td>
</tr>

<tr>
<td>Clayton Kershaw</td>
<td>149.2</td>
<td>1.68</td>
<td>0.722</td>
<td>0.256</td>
<td>1.78</td>
<td>0.202</td>
</tr>

<tr>
<td>Aroldis Chapman</td>
<td>58.0</td>
<td>1.55</td>
<td>0.862</td>
<td>0.268</td>
<td>1.42</td>
<td>0.206</td>
</tr>

<tr>
<td>Andrew Miller</td>
<td>74.1</td>
<td>1.45</td>
<td>0.686</td>
<td>0.258</td>
<td>1.68</td>
<td>0.209</td>
</tr>
</tbody>
</table>

<p>Edwards stands out negatively in several respects here. He pitched the least innings out of that group by far, and was almost certainly put in the least stressful situations. His ERA is almost two points higher than the next highest&rsquo;s, and his FIP is nearly a point higher than Britton&rsquo;s, the second highest mark. His BABIP is also remarkably low, due in part to luck and in part to the Cubs&rsquo; historically good defense. So why is his wOBA so remarkable?</p>

<p>Looking through Edwards&rsquo; <a href="http://www.baseball-reference.com/players/gl.fcgi?id=edwarca01&amp;t=p&amp;year=2016">game log</a>, two bad appearances stand out:</p>

<ol>
<li>August 13th, where he allowed five runs on one hit and four walks while recording just two outs.</li>
<li>September 17th, where he allowed three runs on three hits (two of them home runs) in an inning&rsquo;s work.</li>
</ol>

<p>If we remove the August 13th outing, Edwards&rsquo; ERA drops to <code>2.55</code>, almost an entire point. If we remove the September 17th outing as well, it drops to <code>1.83</code>. Removing the first performance, his FIP drops to <code>2.56</code>. Removing the other brings it down to <code>1.96</code>, which is still higher than the other five pitchers (possibly due to his BABIP) but much closer. Bad pitching performances are part of a pitcher&rsquo;s year, and shouldn&rsquo;t be entirely disregarded. However, it seems likely that <em>something</em> was off (mechanically, physically, or mentally) on August 13th.</p>

<p>We&rsquo;ll get back to these games later.</p>

<p>As the Cubs consistently carried three catchers last season, I thought it would be interesting to compare Edwards&rsquo; performance across all three:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>cej_by_catcher &lt;- cej %&gt;%
  group_by(pitch_type, catcher) %&gt;%
  summarize(n = n(),
            avg_mph = <span style="color: #0000aa">mean</span>(<span style="color: #0000aa">as.numeric</span>(<span style="color: #0000aa">as.character</span>(start_speed)), na.rm = <span style="color: #0000aa">TRUE</span>),
            avg_spin = <span style="color: #0000aa">mean</span>(<span style="color: #0000aa">as.numeric</span>(<span style="color: #0000aa">as.character</span>(spin_rate)), na.rm = <span style="color: #0000aa">TRUE</span>),
            avg_hit_distance = <span style="color: #0000aa">mean</span>(hit_distance_sc, na.rm = <span style="color: #0000aa">TRUE</span>),
            avg_hit_speed = <span style="color: #0000aa">mean</span>(hit_speed, na.rm = <span style="color: #0000aa">TRUE</span>),
            avg_hit_angle = <span style="color: #0000aa">mean</span>(hit_angle, na.rm = <span style="color: #0000aa">TRUE</span>),
            avg_barrel = <span style="color: #0000aa">mean</span>(barrel, na.rm = <span style="color: #0000aa">TRUE</span>),
            avg_ext = <span style="color: #0000aa">mean</span>(release_extension, na.rm = <span style="color: #0000aa">TRUE</span>)) %&gt;%
  mutate(pitch_pct = n/<span style="color: #0000aa">sum</span>(n)) %&gt;%
  filter(pitch_type != <span style="color: #aa5500">&quot;CH&quot;</span>, pitch_type != <span style="color: #aa5500">&quot;IN&quot;</span>) <span style="color: #aaaaaa; font-style: italic"># These each occur once and may be mistakes</span>
</pre></div>

<p>The <code>baseballr</code> package also allows us to look at Statcast data from Baseball Savant:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>cej &lt;- scrape_statcast_savant_pitcher(start_date = <span style="color: #aa5500">&quot;2016-04-06&quot;</span>, end_date = <span style="color: #aa5500">&quot;2016-10-15&quot;</span>, pitcherid = <span style="color: #009999">605218</span>)
</pre></div>

<table>
<thead>
<tr>
<th align="center">type</th>
<th align="center">catcher</th>
<th align="center">count</th>
<th align="center">mph</th>
<th align="center">hit_dist</th>
<th align="center">hit_spd</th>
<th align="center">pct</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">CU</td>
<td align="center">Ross</td>
<td align="center">27</td>
<td align="center">81.16</td>
<td align="center">119</td>
<td align="center">73.6</td>
<td align="center">16.67%</td>
</tr>

<tr>
<td align="center">CU</td>
<td align="center">Montero</td>
<td align="center">53</td>
<td align="center">81.54</td>
<td align="center">258.8</td>
<td align="center">94.86</td>
<td align="center">32.72%</td>
</tr>

<tr>
<td align="center">CU</td>
<td align="center">Federowicz</td>
<td align="center">3</td>
<td align="center">81.25</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">1.85%</td>
</tr>

<tr>
<td align="center">CU</td>
<td align="center">Contreras</td>
<td align="center">79</td>
<td align="center">81.02</td>
<td align="center">208.8</td>
<td align="center">87.74</td>
<td align="center">48.77%</td>
</tr>

<tr>
<td align="center">FF</td>
<td align="center">Ross</td>
<td align="center">99</td>
<td align="center">95.72</td>
<td align="center">186.8</td>
<td align="center">84.31</td>
<td align="center">21.57%</td>
</tr>

<tr>
<td align="center">FF</td>
<td align="center">Montero</td>
<td align="center">147</td>
<td align="center">95.44</td>
<td align="center">211.1</td>
<td align="center">83.77</td>
<td align="center">32.03%</td>
</tr>

<tr>
<td align="center">FF</td>
<td align="center">Federowicz</td>
<td align="center">9</td>
<td align="center">95.77</td>
<td align="center">183</td>
<td align="center">95.5</td>
<td align="center">1.96%</td>
</tr>

<tr>
<td align="center">FF</td>
<td align="center">Contreras</td>
<td align="center">204</td>
<td align="center">95.44</td>
<td align="center">199.4</td>
<td align="center">85.94</td>
<td align="center">44.44%</td>
</tr>
</tbody>
</table>

<p>From the table, we can see that Edwards throws two main pitches—a four-seam fastball and a curveball. He pitched most often to Willson Contreras, then Miguel Montero, then David Ross (and once to Tim Federowicz). Edwards threw his fastball a notch faster to Ross than other catchers, which could be due to the small sample size. He also threw his fastball more to Ross than other catchers: despite throwing 16.67% of his curveballs to Ross, he threw 21.57% of his fastballs to him. There are several reasons this might be the case:</p>

<ol>
<li>Edwards focused on his fastball earlier in the season before gaining more confidence in his curve.</li>
<li>Ross saw that Edwards&rsquo; fastball was producing better results and called it more often.</li>
<li>Contreras was more confident in his agility and therefore ability to block a curveball than Ross was.</li>
<li>Random sampling and a small sample size.</li>
</ol>

<p>Let&rsquo;s take a look at the results these pitches got. By plotting hit velocity and hit distance, we can compare results across catchers:</p>

<p><img src="/images/cevd1.png" alt="blah" /></p>

<p>When Ross was catching, Edwards tended to generate softer contact that went shorter distances. We can use the Statcast data to see why that is.</p>

<p><img src="/images/cesv1.png" alt="blah" /></p>

<p>This chart, plotting spin against pitch velocity, shows something interesting: Edwards&rsquo; pitches had the highest spin when throwing to Ross. Curveballs with higher spin tend to induce more ground balls<sup class="footnote-ref" id="fnref:2"><a rel="footnote" href="#fn:2">2</a></sup>, which is advantageous for Edwards thanks in part to the defense behind him. High spin on his four-seamer is essential to Edwards&rsquo; style, and that was maximized when Ross was catching. Of course, this isn&rsquo;t necessarily related to the catcher. It could be the case that Ross just happened to catch Edwards on his better days. For greater parity, we can look to see what happens to Contreras&rsquo; numbers if we take away the two worst games in Edwards&rsquo; season.</p>

<p><img src="/images/cevd2.png" alt="blah" /></p>

<p>Already we see that removing the two bad outings brings Contreras much closer to Ross and  Montero in terms of average hit speed and hit distance. Now we can look at how removing the bad outing affects velocity and spin.</p>

<p><img src="/images/cesv2.png" alt="blah" /></p>

<p>There isn&rsquo;t any effect on the spin of Edwards&rsquo; curveball while Contreras is catching, but the spin on his fastball gets much closer to Ross than Montero. Let&rsquo;s compare Edwards&rsquo; Statcast data between the August 13th outing and his overall averages (the bolded rows are from the 13th):</p>

<table>
<thead>
<tr>
<th>Type</th>
<th>MPH</th>
<th>Spin</th>
<th>Ext</th>
</tr>
</thead>

<tbody>
<tr>
<td>FF</td>
<td>95.55</td>
<td>1876</td>
<td>6.85</td>
</tr>

<tr>
<td><strong>FF</strong></td>
<td><strong>94.60</strong></td>
<td><strong>1602</strong></td>
<td><strong>6.73</strong></td>
</tr>

<tr>
<td>CU</td>
<td>81.20</td>
<td>1605</td>
<td>6.31</td>
</tr>

<tr>
<td><strong>CU</strong></td>
<td><strong>81.49</strong></td>
<td><strong>1480</strong></td>
<td><strong>6.19</strong></td>
</tr>
</tbody>
</table>

<p>If we add in the other poor outing:</p>

<table>
<thead>
<tr>
<th>Type</th>
<th>MPH</th>
<th>Spin</th>
<th>Ext</th>
</tr>
</thead>

<tbody>
<tr>
<td>FF</td>
<td>95.54</td>
<td>1873</td>
<td>6.85</td>
</tr>

<tr>
<td><strong>FF</strong></td>
<td><strong>95.08</strong></td>
<td><strong>1749</strong></td>
<td><strong>6.74</strong></td>
</tr>

<tr>
<td>CU</td>
<td>81.23</td>
<td>1610</td>
<td>6.31</td>
</tr>

<tr>
<td><strong>CU</strong></td>
<td><strong>81.12</strong></td>
<td><strong>1502</strong></td>
<td><strong>6.26</strong></td>
</tr>
</tbody>
</table>

<p>Adding in the second bad outing makes the numbers more similar, lending credence to the idea that the first outing was an outlier. On August 13th the spin on his fastball, his extension, and his velocity were all down a tick.</p>

<p>Carl Edwards had a quietly great year out of the bullpen for the Cubs. He was among the league leaders in wOBA-against, which is initially surprising based on his peripheral numbers. Upon removing an outing where the spin rate and velocity on his signature pitch took a steep downturn, Edwards&rsquo; peripheral numbers match up more closely with the type of performance you&rsquo;d expect from someone in that elite group of pitchers. Carl Edwards had a bad day—here&rsquo;s to more good ones.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">As part of this analysis, I defined a function <code>playername_lookup</code> that gets a player&rsquo;s name from their MLBAM id (this function is based on the <code>playerid_lookup</code> function from the <code>baseballr</code> package). It is provided <a href="https://gist.github.com/benfb/c2be996bcdbf0b1fa9f7f544fceb2934">here</a> for reference.
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
<li id="fn:2"><a href="http://m.mlb.com/news/article/160896926/statcast-spin-rate-compared-to-velocity/">http://m.mlb.com/news/article/160896926/statcast-spin-rate-compared-to-velocity/</a>
 <a class="footnote-return" href="#fnref:2"><sup>[return]</sup></a></li>
</ol>
</div>

  </div>
    
  
        
  <div class="post">
    <h1 class="post-title">
      <a href="https://baseball.benbailey.me/2017/03/events-and-dynamic-ui/">
        Events and Dynamic UI
      </a>
    </h1>

    <span class="post-date">Fri, Mar 3, 2017</span>

    <p>This week I focused on improving the usability of the Shiny app. I used Shiny&rsquo;s
<code>renderUI</code> function to dynamically generate the options for the game select
dropdown. I also set up a baseball API <a href="http://bbbaseball.herokuapp.com">here</a>, and added another API
endpoint to get the list of games that happened on any given day.</p>

<p>One of the nicer things I added to the Shiny app was the use of the <code>tryCatch</code>
function to hide confusing error messages from the user, like this:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #0000aa">tryCatch</span>({
     splitGames &lt;- <span style="color: #0000aa">unlist</span>(<span style="color: #0000aa">strsplit</span>(input$game, <span style="color: #aa5500">&quot; @ &quot;</span>))
     away &lt;- teams[<span style="color: #0000aa">which</span>(<span style="color: #0000aa">grepl</span>(splitGames[<span style="color: #009999">1</span>], <span style="color: #0000aa">names</span>(teams)))]
     home &lt;- teams[<span style="color: #0000aa">which</span>(<span style="color: #0000aa">grepl</span>(splitGames[<span style="color: #009999">2</span>], <span style="color: #0000aa">names</span>(teams)))]

     data &lt;- getEvents(year, month, day, away, home)
     sliderInput(<span style="color: #aa5500">&quot;event&quot;</span>, <span style="color: #aa5500">&quot;Event:&quot;</span>,
                 min = <span style="color: #009999">1</span>, max = <span style="color: #0000aa">length</span>(data$probabilities),
                 value = <span style="color: #0000aa">length</span>(data$probabilities), sep = <span style="color: #009999">1</span>)
   }, error = <span style="color: #0000aa">function</span>(e) {
     <span style="color: #0000aa">stop</span>(<span style="color: #aa5500">&quot;That is not a valid event&quot;</span>)
   })
</pre></div>

<p>In reality, much of my week was spent fighting with R&rsquo;s several methods of
dealing with strings and arrays. Most of the changes this week were in the front
end user-facing part of the app, so I&rsquo;m excited to work more on the backend next
week (maybe finally improving the win probability calculation?). As a side note,
the app does generally work for spring training games (as long as Gameday is
working at the moment).</p>

  </div>
    
  
        
  <div class="post">
    <h1 class="post-title">
      <a href="https://baseball.benbailey.me/2017/02/an-app/">
        An App!
      </a>
    </h1>

    <span class="post-date">Wed, Feb 22, 2017</span>

    <p>This week I made a Shiny interface to the win probability and description services.
It can be viewed <a href="https://benfb.shinyapps.io/bbbaseball">here</a>. To do this, I had to set up hosting for
both Shiny and my Elixir backend service. I also switched from embedding/posting
the plots on Plotly to embedding them in the new Shiny application, which should
help reduce costs. Learning more about Shiny made implementing the interface
relatively simple. The generation of the graphs is now abstracted into a
function that grabs JSON data from the API server I set up, which makes it much
easier to generate graphs for any desired game.</p>

<p>I would like to make several improvements to the graph next week. Including
scores would be helpful. Perhaps most interesting would be implementing
automatic &ldquo;swing-point&rdquo; detection and adding concise labels for the greatest
win probability changes in a game. Finally, it would be nice if there were a
way to view which teams played on which days, as right now it&rsquo;s difficult to
find a game that you want to graph.</p>

  </div>
    
  
        
  
        
  <div class="post">
    <h1 class="post-title">
      <a href="https://baseball.benbailey.me/2017/02/descriptions-and-probabilities/">
        Descriptions and Probabilities
      </a>
    </h1>

    <span class="post-date">Wed, Feb 8, 2017</span>

    <p>This week I mostly focused on experimenting with the Retrosheet and MLB Gameday API formats.
Using the <code>baseball</code> umbrella application combined with R and Plotly, I generated a win expectancy
graph for a random game.</p>

<p>In any given situation, the win expectancy is equivalent to the percentage of games
that teams in that exact situation went on to win. To calculate the win probability of
a situation, the application converts the situation into a hash using the number of outs,
inning, number and position of base runners, and the current score, then looks it up in a
table of historical win probabilities. This table was calculated using <a href="https://gregstoll.dyndns.org/~gregstoll/baseball/stats.html">Greg Stoll&rsquo;s scripts</a>
and <a href="http://www.retrosheet.org">Retrosheet</a> data. The code for the win expectancy service can be found
<a href="https://github.com/benfb/baseball/tree/master/apps/baseball_win_ex">here</a>, and the general downloader&rsquo;s source is <a href="https://github.com/benfb/baseball/tree/master/apps/baseball_slurper">here</a>. What follows
is an example of a manually-generated win expectancy graph of the game that occurred
on May 10th of last season between the Padres and the Cubs.</p>

<p>First, we utilize the two functions <code>probabilities_from_game/2</code> and <code>descriptions_from_game/2</code>
to get vectors of win expectancies and descriptions of every event that occurred in the game:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>iex(<span style="color: #009999">1</span>)&gt; <span style="color: #00aa00; text-decoration: underline">BaseballSlurper.Server</span>.probabilities_from_game(<span style="color: #aa5500">&quot;2016-05-10&quot;</span>, [<span style="color: #aa5500">&quot;sdn&quot;</span>, <span style="color: #aa5500">&quot;chn&quot;</span>])
[[<span style="color: #009999">0.5652355266525733</span>, <span style="color: #009999">0.5826495329514373</span>, <span style="color: #009999">0.593064127007075</span>],
 [<span style="color: #009999">0.5669081828973761</span>, <span style="color: #009999">0.5470361185179661</span>, <span style="color: #009999">0.534091190836288</span>],
 [<span style="color: #009999">0.5569277494191046</span>, <span style="color: #009999">0.5742743999613658</span>, <span style="color: #009999">0.5803200220916497</span>],...]

iex(<span style="color: #009999">2</span>)&gt; <span style="color: #00aa00; text-decoration: underline">BaseballSlurper.Server</span>.descriptions_from_game(<span style="color: #aa5500">&quot;2016-05-10&quot;</span>, [<span style="color: #aa5500">&quot;sdn&quot;</span>, <span style="color: #aa5500">&quot;chn&quot;</span>])
[[<span style="color: #aa5500">&quot;Jon Jay grounds out, second baseman Ben Zobrist to first baseman Anthony Rizzo.&quot;</span>,
  <span style="color: #aa5500">&quot;Wil Myers flies out to center fielder Dexter Fowler.&quot;</span>,
  <span style="color: #aa5500">&quot;Matt Kemp lines out to center fielder Dexter Fowler.&quot;</span>],
 [<span style="color: #aa5500">&quot;Dexter Fowler strikes out swinging.&quot;</span>,
  <span style="color: #aa5500">&quot;Jason Heyward lines out to center fielder Jon Jay.&quot;</span>,
  <span style="color: #aa5500">&quot;Kris Bryant lines out to right fielder Matt Kemp.&quot;</span>],...]
</pre></div>

<p>We can then plug these two vectors into R to get an interactive win expectancy graph with Plotly:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #0000aa">library</span>(plotly)
<span style="color: #0000aa">Sys.setenv</span>(<span style="color: #aa5500">&quot;plotly_username&quot;</span> = <span style="color: #aa5500">&quot;benfb&quot;</span>)
<span style="color: #0000aa">Sys.setenv</span>(<span style="color: #aa5500">&quot;plotly_api_key&quot;</span> = API_KEY)
probabilities &lt;- <span style="color: #00aaaa">c</span>(PROBABILITY_VECTOR)
x &lt;- <span style="color: #0000aa">seq_along</span>(y)
event &lt;- <span style="color: #00aaaa">c</span>(DESCRIPTION_VECTOR)
data &lt;- <span style="color: #00aaaa">data.frame</span>(x, y, event)

kb &lt;- <span style="color: #00aaaa">list</span>(
  xref = <span style="color: #aa5500">&#39;paper&#39;</span>,
  yref = <span style="color: #aa5500">&#39;y&#39;</span>,
  x = <span style="color: #0000aa">seq</span>(<span style="color: #009999">0</span>, <span style="color: #009999">1</span>, by=(<span style="color: #009999">1</span>/<span style="color: #0000aa">length</span>(x)))[<span style="color: #009999">23</span>],
  y = probabilities[<span style="color: #009999">23</span>],
  xanchor = <span style="color: #aa5500">&#39;right&#39;</span>,
  yanchor = <span style="color: #aa5500">&#39;middle&#39;</span>,
  text = <span style="color: #aa5500">&#39;K Bryant Double&#39;</span>,
  font = <span style="color: #00aaaa">list</span>(family = <span style="color: #aa5500">&#39;Arial&#39;</span>,
              size = <span style="color: #009999">16</span>,
              color = <span style="color: #aa5500">&#39;rgba(67,67,67,1)&#39;</span>),
  showarrow = <span style="color: #0000aa">FALSE</span>)

ad &lt;- <span style="color: #00aaaa">list</span>(
  xref = <span style="color: #aa5500">&#39;paper&#39;</span>,
  yref = <span style="color: #aa5500">&#39;y&#39;</span>,
  x = <span style="color: #0000aa">seq</span>(<span style="color: #009999">0</span>, <span style="color: #009999">1</span>, by=(<span style="color: #009999">1</span>/<span style="color: #0000aa">length</span>(x)))[<span style="color: #009999">72</span>],
  y = probabilities[<span style="color: #009999">72</span>],
  xanchor = <span style="color: #aa5500">&#39;right&#39;</span>,
  yanchor = <span style="color: #aa5500">&#39;middle&#39;</span>,
  text = <span style="color: #aa5500">&#39;A Dickerson Home Run&#39;</span>,
  font = <span style="color: #00aaaa">list</span>(family = <span style="color: #aa5500">&#39;Arial&#39;</span>,
              size = <span style="color: #009999">16</span>,
              color = <span style="color: #aa5500">&#39;rgba(67,67,67,1)&#39;</span>),
  showarrow = <span style="color: #0000aa">FALSE</span>)

p &lt;- plot_ly(
  data,
  x = <span style="color: #0000aa">seq_along</span>(y),
  y = probabilities,
  type = <span style="color: #aa5500">&#39;scatter&#39;</span>,
  mode = <span style="color: #aa5500">&#39;lines&#39;</span>,
  text = event) %&gt;%
layout(
  title = <span style="color: #aa5500">&#39;SDN @ CHN 2016-05-10&#39;</span>,
  xaxis = <span style="color: #00aaaa">list</span>(title = <span style="color: #aa5500">&#39;Game Event&#39;</span>),
  yaxis = <span style="color: #00aaaa">list</span>(title = <span style="color: #aa5500">&#39;Home Team Win Probability&#39;</span>)) %&gt;%
layout(annotations = <span style="color: #00aaaa">list</span>(kb, ad))
</pre></div>

<p>This R code yields the following chart:</p>

<iframe width="100%" height="500" frameborder="0" scrolling="no" src="//plot.ly/~benfb/0.embed"></iframe>

<p>For comparison, the Fangraph&rsquo;s win expectancy graph is <a href="http://www.fangraphs.com/wins.aspx?date=2016-05-10&amp;team=Cubs&amp;dh=0&amp;season=2016">here</a>, and you can find
the full video of the game on <a href="https://www.youtube.com/watch?v=wGqoB_8hNtw">MLB&rsquo;s YouTube channel</a><sup class="footnote-ref" id="fnref:1"><a rel="footnote" href="#fn:1">1</a></sup>.</p>

<p>The next step will be to automate this process and look into self-hosting
the graphs instead of going through Plotly&rsquo;s rate-limited API.</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">The date in the title of this video is actually incorrect. It&rsquo;s actually the game from May 10th.
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
</ol>
</div>

  </div>
    
  
</div>
</div>

  </body>
</html>
